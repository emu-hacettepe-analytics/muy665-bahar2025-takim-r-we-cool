---
title: "MUY660-project"
author: "R_we_cool"
date: "2025"
format: html
number-sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(ggplot2)
library(GGally)
library(stringr)
library(dplyr)
library(car)
getwd()
data <- read.csv("laptops.csv")
head(data)
```

```{r}
# Missing values are added to the data
library(missForest)
data_new = prodNA(data, noNA = 0.075)
sum(is.na(data_new)) # we can see the NA values are added 

```

```{r}
str(data_new)
```

```{r}
summary(data_new)
```

```{r}
sum(is.na(data_new))
sum(duplicated(data_new)) # no duplicated 
dim(data_new)
```

```{r}
# Calculate descriptive statistics
descriptive_stats <- data_new %>%
  summarise(across(where(is.numeric), list(
    mean = ~mean(.x, na.rm = TRUE),
    sd = ~sd(.x, na.rm = TRUE)
  )))


print(descriptive_stats)
```

```{r}
# Convert relevant columns to factors
data_new$brand <- as.factor(data_new$brand)
data_new$Model <- as.factor(data_new$Model)
data_new$processor_brand <- as.factor(data_new$processor_brand)
data_new$processor_tier <- as.factor(data_new$processor_tier)
data_new$primary_storage_type <- as.factor(data_new$primary_storage_type)
data_new$secondary_storage_type <- as.factor(data_new$secondary_storage_type)
data_new$gpu_brand <- as.factor(data_new$gpu_brand)
data_new$gpu_type <- as.factor(data_new$gpu_type)
data_new$OS <- as.factor(data_new$OS)
data_new$is_touch_screen <- as.factor(data_new$is_touch_screen)
data_new$year_of_warranty <- as.factor(data_new$year_of_warranty)
data_new$ram_memory <- as.factor(data_new$ram_memory)
data_new$num_cores <- as.factor(data_new$num_cores)

# Convert relevant columns to numeric
data_new$Price <- as.numeric(data_new$Price)
data_new$Rating <- as.numeric(data_new$Rating)
data_new$num_threads <- as.numeric(data_new$num_threads)
data_new$primary_storage_capacity <- as.numeric(data_new$primary_storage_capacity)
data_new$secondary_storage_capacity <- as.numeric(data_new$secondary_storage_capacity)
data_new$display_size <- as.numeric(data_new$display_size)
data_new$resolution_width <- as.numeric(data_new$resolution_width)
data_new$resolution_height <- as.numeric(data_new$resolution_height)

# View the structure of the cleaned data frame
str(data_new)
summary(data_new)
```

"Are there any notable differences in the frequencies of processor tiers?"

```{r}
library(ggplot2)
f=table(data$processor_tier)
f_data=data.frame(f) 
ggplot(f_data,aes(x=reorder(Var1,Freq),y=Freq,fill=Var1))+geom_bar(stat="identity")+
  labs(title="Bar Plot of Processor Brands",y="Frequencies",x="Levels")
```

When the bar plot was examined, the majority of the processor tiers is corre i5. Theoretically, it might be said that most of the customers are satisfied with the performance of the core i5.

Histogram of Laptop Ratings (dependent variable)

```{r}
ggplot(data_new, aes(x=Rating)) + geom_histogram(binwidth=5, fill='green3', color='black') + theme_minimal() + ggtitle('Histogram of Laptop Ratings')

```

What is the impact of GPU brand (e.g., NVIDIA, AMD) on laptops' Ratings? Null Hypothesis (H0): There is no significant difference in ratings between different GPU brands. Alternative Hypothesis (H1): There is a significant difference in ratings between different GPU

```{r}
summary_table_rating <- data_new %>%
  group_by(gpu_brand) %>%
  summarise(average_rating = mean(Rating, na.rm = TRUE))

ggplot(summary_table_rating, aes(x=gpu_brand, y=average_rating, fill=gpu_brand)) +
  geom_bar(stat='identity') +
  ggtitle('Average Ratings by GPU Brand') +
  xlab('GPU Brand') +
  ylab('Average Rating') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

What is the impact of GPU brand (e.g., NVIDIA, AMD) on laptop prices?

```{r}
summary_table_price <- data_new %>%
  group_by(gpu_brand) %>%
  summarise(average_price = mean(Price, na.rm = TRUE))

ggplot(summary_table_price, aes(x=gpu_brand, y=average_price, fill=gpu_brand)) +
  geom_bar(stat='identity') +
  ggtitle('Average Prices by GPU Brand') +
  xlab('GPU Brand') +
  ylab('Average Price') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

How the price of laptops differs from according to their processor brand and gpu type?

```{r}
ggplot(data_new, aes(x = processor_brand, y = Price, color = gpu_type)) +
  geom_point(alpha = 0.6) +
  labs(title = 'Price vs Processor Brand by GPU Type', x = 'Processor Brand', y = 'Price') +
  theme_minimal() +
  scale_y_continuous(labels = scales::dollar_format(prefix = '$'))
```

Plot showing the relationship between processor brand and price, colored by GPU type

How the rating of laptops differs from according to theit processor brand and gpu type?

```{r}
ggplot(data_new, aes(x = processor_brand, y = Rating, color = gpu_type)) +
  geom_point(alpha = 0.6) +
  labs(title = 'Rating vs Processor Brand by GPU Type', x = 'Processor Brand', y = 'Price') +
  theme_minimal() +
  scale_y_continuous(labels = scales::dollar_format(prefix = '$'))

```

Is there a relationship between number of cores and laptops' ratings according to processor brand?

```{r}
ggplot(data_new, aes(x = num_cores, y = Rating, color = processor_brand)) +
  geom_point() +
  labs(title = "Number of Cores vs. Rating",
       x = "Number of Cores",
       y = "Rating") +
  theme_minimal()

```

It might be said that, there is an linear relationships number of cores and ratings.

Is there a correlation between price and rating?

```{r}
cor(data_new$Price, data_new$Rating, use='complete.obs')
ggplot(data_new, aes(x=Price, y=Rating)) +
  geom_point() +
  geom_smooth(method='lm', col='blue') +
  ggtitle('Scatter Plot of Price vs Rating') +
  xlab('Price') +
  ylab('Rating')
```

As observed, there is a moderate to positive correlation between the two variables, with a correlation coefficient of approximately 0.661.

How do ratings vary with different primary storage types and capacities?

```{r}
ggplot(data_new, aes(x=primary_storage_capacity, y=Rating, fill=primary_storage_type)) +
  geom_boxplot() +
  ggtitle('Ratings by Primary Storage Type and Capacity') +
  xlab('Primary Storage Capacity') +
  ylab('Rating') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The box plot indicates a clear preference for laptops with SSDs over HDDs, particularly those with higher storage capacities, as evidenced by higher and more consistent ratings.

How do ratings vary with different combinations of processor brand, GPU brand, and RAM memory?

```{r}
library(dplyr)
summary_table <- data_new %>%
  group_by(processor_brand, gpu_brand, ram_memory) %>%
  summarise(average_rating = mean(Rating, na.rm = TRUE))
ggplot(summary_table, aes(x=ram_memory, y=interaction(processor_brand, gpu_brand), fill=average_rating)) +
  geom_tile() +
  scale_fill_gradient(low='blue', high='red') +
  ggtitle('Heatmap of Ratings by Processor Brand, GPU Brand, and RAM Memory') +
  xlab('RAM Memory (GB)') +
  ylab('Processor Brand and GPU Brand') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

laptops with higher RAM capacities and combinations of AMD or Intel processors with NVIDIA GPUs tend to receive higher ratings.

How do different laptop brands (e.g., Dell, HP, Lenovo) affect the average rating? Hypothesis: Certain brands, such as Apple, have higher average ratings compared to others.

```{r}
summary_table_rating <- data_new %>%
  group_by(brand) %>%
  summarise(average_rating = mean(Rating, na.rm = TRUE))

ggplot(summary_table_rating, aes(x=brand, y=average_rating, fill=brand)) +
  geom_bar(stat='identity') +
  ggtitle('Average Ratings by Laptop Brand') +
  xlab('Laptop Brand') +
  ylab('Average Rating') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The brand of a laptop significantly impacts its average rating, with Asus and Acer leading in customer satisfaction, while Axl and Avita lag behind.

*4. Exploration of the missingness mechanism and impute missing values and validate it.*

```{r}
sum(is.na(data_new))# to check the number of NA values in dataset
```

```{r}
#fixing index column
data_new$index <- c(1:991)
sum(is.na(data_new$index))
#removing columns which are unnecessary
laptops <- data_new[,-c(3,13,14,17,18,19,20,22)]
head(laptops)

str(laptops)


```



There are no NA values in the dataset. All of them were imputed.


