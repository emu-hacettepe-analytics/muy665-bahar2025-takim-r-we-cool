---
title: "MUY660-project"
author: "R_we_cool"
date: "2025"
format: html
number-sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(ggplot2)
library(GGally)
library(stringr)
library(dplyr)
library(car)
getwd()
data <- read.csv("laptops.csv")
head(data)
```

```{r}
# Missing values are added to the data
library(missForest)
data_new = prodNA(data, noNA = 0.075)
sum(is.na(data_new)) # we can see the NA values are added 

```

```{r}
str(data_new)
```

```{r}
summary(data_new)
```

```{r}
sum(is.na(data_new))
sum(duplicated(data_new)) # no duplicated 
dim(data_new)
```

```{r}
# Calculate descriptive statistics
descriptive_stats <- data_new %>%
  summarise(across(where(is.numeric), list(
    mean = ~mean(.x, na.rm = TRUE),
    sd = ~sd(.x, na.rm = TRUE)
  )))


print(descriptive_stats)
```

```{r}
# Convert relevant columns to factors
data_new$brand <- as.factor(data_new$brand)
data_new$Model <- as.factor(data_new$Model)
data_new$processor_brand <- as.factor(data_new$processor_brand)
data_new$processor_tier <- as.factor(data_new$processor_tier)
data_new$primary_storage_type <- as.factor(data_new$primary_storage_type)
data_new$secondary_storage_type <- as.factor(data_new$secondary_storage_type)
data_new$gpu_brand <- as.factor(data_new$gpu_brand)
data_new$gpu_type <- as.factor(data_new$gpu_type)
data_new$OS <- as.factor(data_new$OS)
data_new$is_touch_screen <- as.factor(data_new$is_touch_screen)
data_new$year_of_warranty <- as.factor(data_new$year_of_warranty)
data_new$ram_memory <- as.factor(data_new$ram_memory)
data_new$num_cores <- as.factor(data_new$num_cores)

# Convert relevant columns to numeric
data_new$Price <- as.numeric(data_new$Price)
data_new$Rating <- as.numeric(data_new$Rating)
data_new$num_threads <- as.numeric(data_new$num_threads)
data_new$primary_storage_capacity <- as.numeric(data_new$primary_storage_capacity)
data_new$secondary_storage_capacity <- as.numeric(data_new$secondary_storage_capacity)
data_new$display_size <- as.numeric(data_new$display_size)
data_new$resolution_width <- as.numeric(data_new$resolution_width)
data_new$resolution_height <- as.numeric(data_new$resolution_height)

# View the structure of the cleaned data frame
str(data_new)
summary(data_new)
```

"Are there any notable differences in the frequencies of processor tiers?"

```{r}
library(ggplot2)
f=table(data$processor_tier)
f_data=data.frame(f) 
ggplot(f_data,aes(x=reorder(Var1,Freq),y=Freq,fill=Var1))+geom_bar(stat="identity")+
  labs(title="Bar Plot of Processor Brands",y="Frequencies",x="Levels")
```

When the bar plot was examined, the majority of the processor tiers is corre i5. Theoretically, it might be said that most of the customers are satisfied with the performance of the core i5.

Histogram of Laptop Ratings (dependent variable)

```{r}
ggplot(data_new, aes(x=Rating)) + geom_histogram(binwidth=5, fill='green3', color='black') + theme_minimal() + ggtitle('Histogram of Laptop Ratings')

```

What is the impact of GPU brand (e.g., NVIDIA, AMD) on laptops' Ratings? Null Hypothesis (H0): There is no significant difference in ratings between different GPU brands. Alternative Hypothesis (H1): There is a significant difference in ratings between different GPU

```{r}
summary_table_rating <- data_new %>%
  group_by(gpu_brand) %>%
  summarise(average_rating = mean(Rating, na.rm = TRUE))

ggplot(summary_table_rating, aes(x=gpu_brand, y=average_rating, fill=gpu_brand)) +
  geom_bar(stat='identity') +
  ggtitle('Average Ratings by GPU Brand') +
  xlab('GPU Brand') +
  ylab('Average Rating') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

What is the impact of GPU brand (e.g., NVIDIA, AMD) on laptop prices?

```{r}
summary_table_price <- data_new %>%
  group_by(gpu_brand) %>%
  summarise(average_price = mean(Price, na.rm = TRUE))

ggplot(summary_table_price, aes(x=gpu_brand, y=average_price, fill=gpu_brand)) +
  geom_bar(stat='identity') +
  ggtitle('Average Prices by GPU Brand') +
  xlab('GPU Brand') +
  ylab('Average Price') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

How the price of laptops differs from according to their processor brand and gpu type?

```{r}
ggplot(data_new, aes(x = processor_brand, y = Price, color = gpu_type)) +
  geom_point(alpha = 0.6) +
  labs(title = 'Price vs Processor Brand by GPU Type', x = 'Processor Brand', y = 'Price') +
  theme_minimal() +
  scale_y_continuous(labels = scales::dollar_format(prefix = '$'))
```

Plot showing the relationship between processor brand and price, colored by GPU type

How the rating of laptops differs from according to theit processor brand and gpu type?

```{r}
ggplot(data_new, aes(x = processor_brand, y = Rating, color = gpu_type)) +
  geom_point(alpha = 0.6) +
  labs(title = 'Rating vs Processor Brand by GPU Type', x = 'Processor Brand', y = 'Price') +
  theme_minimal() +
  scale_y_continuous(labels = scales::dollar_format(prefix = '$'))

```

Is there a relationship between number of cores and laptops' ratings according to processor brand?

```{r}
ggplot(data_new, aes(x = num_cores, y = Rating, color = processor_brand)) +
  geom_point() +
  labs(title = "Number of Cores vs. Rating",
       x = "Number of Cores",
       y = "Rating") +
  theme_minimal()

```

It might be said that, there is an linear relationships number of cores and ratings.

Is there a correlation between price and rating?

```{r}
cor(data_new$Price, data_new$Rating, use='complete.obs')
ggplot(data_new, aes(x=Price, y=Rating)) +
  geom_point() +
  geom_smooth(method='lm', col='blue') +
  ggtitle('Scatter Plot of Price vs Rating') +
  xlab('Price') +
  ylab('Rating')
```

As observed, there is a moderate to positive correlation between the two variables, with a correlation coefficient of approximately 0.661.

How do ratings vary with different primary storage types and capacities?

```{r}
ggplot(data_new, aes(x=primary_storage_capacity, y=Rating, fill=primary_storage_type)) +
  geom_boxplot() +
  ggtitle('Ratings by Primary Storage Type and Capacity') +
  xlab('Primary Storage Capacity') +
  ylab('Rating') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The box plot indicates a clear preference for laptops with SSDs over HDDs, particularly those with higher storage capacities, as evidenced by higher and more consistent ratings.

How do ratings vary with different combinations of processor brand, GPU brand, and RAM memory?

```{r}
library(dplyr)
summary_table <- data_new %>%
  group_by(processor_brand, gpu_brand, ram_memory) %>%
  summarise(average_rating = mean(Rating, na.rm = TRUE))
ggplot(summary_table, aes(x=ram_memory, y=interaction(processor_brand, gpu_brand), fill=average_rating)) +
  geom_tile() +
  scale_fill_gradient(low='blue', high='red') +
  ggtitle('Heatmap of Ratings by Processor Brand, GPU Brand, and RAM Memory') +
  xlab('RAM Memory (GB)') +
  ylab('Processor Brand and GPU Brand') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

laptops with higher RAM capacities and combinations of AMD or Intel processors with NVIDIA GPUs tend to receive higher ratings.

How do different laptop brands (e.g., Dell, HP, Lenovo) affect the average rating? Hypothesis: Certain brands, such as Apple, have higher average ratings compared to others.

```{r}
summary_table_rating <- data_new %>%
  group_by(brand) %>%
  summarise(average_rating = mean(Rating, na.rm = TRUE))

ggplot(summary_table_rating, aes(x=brand, y=average_rating, fill=brand)) +
  geom_bar(stat='identity') +
  ggtitle('Average Ratings by Laptop Brand') +
  xlab('Laptop Brand') +
  ylab('Average Rating') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The brand of a laptop significantly impacts its average rating, with Asus and Acer leading in customer satisfaction, while Axl and Avita lag behind.

*4. Exploration of the missingness mechanism and impute missing values and validate it.*

```{r}
sum(is.na(data_new))# to check the number of NA values in dataset
```

```{r}
#fixing index column
data_new$index <- c(1:991)
sum(is.na(data_new$index))
#removing columns which are unnecessary
laptops <- data_new[,-c(3,13,14,17,18,19,20,22)]
head(laptops)

str(laptops)


```

```         
**Imputation Part**
```

```{r}
library(mice)
imputation_methods <- c("", "cart", "", "", "cart", "cart", "", "cart", "cart", "cart", "", "cart", "cart","cart")
imputed_data <- mice(laptops, method = imputation_methods, m = 5, maxit = 5, seed = 123)

completed_data <- complete(imputed_data, 1)


sum(is.na(completed_data))


```

#brand column

```{r}
sum(is.na(completed_data$brand))
table(completed_data$brand)
# Step 1: Convert the factor column to character
completed_data$brand <- as.character(completed_data$brand)
# Step 2: Replace NA values with mode == "asus"
completed_data$brand[is.na(completed_data$brand)] <- "asus"
# Step 3: Convert the column back to factor
completed_data$brand <- as.factor(completed_data$brand)

summary(completed_data$brand)# Verify the changes

```

#Price column

```{r}
mean(na.omit(laptops$Price)) #77562
completed_data$Price <- ifelse(is.na(completed_data$Price), 77562, laptops$Price)
sum(is.na(completed_data$Price))
str(completed_data$Price)
```

#Rating column

```{r}
mean(na.omit(laptops$Rating))
completed_data$Rating <- ifelse(is.na(completed_data$Rating), 63.82, laptops$Rating)
str(laptops$Rating)
```

#Proccesor_brand

```{r}
sum(is.na(completed_data$processor_brand))
table(laptops$processor_brand)
# Step 1: Convert the factor column to character
completed_data$processor_brand <- as.character(completed_data$processor_brand)
# Step 2: Replace NA values with mode == "intel"
completed_data$processor_brand[is.na(completed_data$processor_brand)] <- "intel"
# Step 3: Convert the column back to factor
completed_data$processor_brand <- as.factor(completed_data$processor_brand)

summary(completed_data$processor_tier)# Verify the changes
sum(is.na(completed_data$processor_brand))
```

#Processor_tier

```{r}
# Step 1: Convert the factor column to character
completed_data$processor_tier <- as.character(completed_data$processor_tier)
# Step 2: Replace NA values with mode == "core i5"
completed_data$processor_tier[is.na(completed_data$processor_tier)] <- "core i5"
# Step 3: Convert the column back to factor
completed_data$processor_tier <- as.factor(completed_data$processor_tier)

summary(completed_data$processor_tier)# Verify the changes

```

#num_cores

```{r}
sum(is.na(completed_data$num_cores)) # 24 NA values
table(laptops$num_cores) # we will impute mode == "6" for NA values 
# Step 1: Convert the factor column to character
completed_data$num_cores <- as.character(completed_data$num_cores)
# Step 2: Replace NA values with mode == "6
completed_data$num_cores[is.na(completed_data$num_cores)] <- "6"
# Step 3: Convert the column back to factor
completed_data$num_cores <- as.factor(completed_data$num_cores)

summary(completed_data$num_cores)# Verify the changes
```

#num_threads

```{r}
sum(is.na(completed_data$num_threads)) # 79 NA values
# Step 1: Calculate the median of the primary_storage_capacity column, ignoring NA values
median_num_threads <- median(laptops$num_threads, na.rm = TRUE)
# Step 2: Replace NA values with the calculated median
completed_data$num_threads[is.na(completed_data$num_threads)] <- median_num_threads

summary(completed_data$num_threads)# Verify the change
```

#ram_memory

```{r}
sum(is.na(completed_data$ram_memory)) # 23 NA values
table(laptops$ram_memory) # we will impute mode == "16" for NA values 
# Step 1: Convert the factor column to character
completed_data$ram_memory <- as.character(completed_data$ram_memory)
# Step 2: Replace NA values with mode == "16"
completed_data$ram_memory[is.na(completed_data$ram_memory)] <- "16"
# Step 3: Convert the column back to factor
completed_data$ram_memory <- as.factor(completed_data$ram_memory)

summary(completed_data$ram_memory)# Verify the changes


```

#primary_storage_type

```{r}
sum(is.na(completed_data$primary_storage_type)) #21 NA values
table(laptops$primary_storage_type) # we will impute mode == "SSD" for NA values 
# Step 1: Convert the factor column to character
completed_data$primary_storage_type <- as.character(completed_data$primary_storage_type)
# Step 2: Replace NA values with mode == "SSD"
completed_data$primary_storage_type[is.na(completed_data$primary_storage_type)] <- "SSD"
# Step 3: Convert the column back to factor
completed_data$primary_storage_type <- as.factor(completed_data$primary_storage_type)

summary(completed_data$primary_storage_type)# Verify the changes
```

# 

```{r}
sum(is.na(completed_data$primary_storage_capacity))
# Step 1: Calculate the median of the primary_storage_capacity column, ignoring NA values
median_num_cores <- median(laptops$primary_storage_capacity, na.rm = TRUE)
# Step 2: Replace NA values with the calculated median
completed_data$primary_storage_capacity[is.na(completed_data$primary_storage_capacity)] <- median_num_cores

summary(completed_data$primary_storage_capacity)# Verify the changes
```

#gpu_brand

```{r}
sum(is.na(completed_data$gpu_brand))# 30 NA values
table(laptops$gpu_brand)#mode == "intel"
# Step 1: Convert the factor column to character
completed_data$gpu_brand <- as.character(completed_data$gpu_brand)
# Step 2: Replace NA values with "intel"
completed_data$gpu_brand[is.na(completed_data$gpu_brand)] <- "intel"
# Step 3: Convert the column back to factor
completed_data$gpu_brand <- as.factor(completed_data$gpu_brand)

summary(completed_data$gpu_brand)# Verify the changes
```

#gpu_type

```{r}
sum(is.na(completed_data$gpu_type))#29 NA values
table(laptops$gpu_type) #mode == "integrated"
# Step 1: Convert the factor column to character
completed_data$gpu_type <- as.character(completed_data$gpu_type)
# Step 2: Replace NA values with "integrated"
completed_data$gpu_type[is.na(completed_data$gpu_type)] <- "integrated"
# Step 3: Convert the column back to factor
completed_data$gpu_type <- as.factor(completed_data$gpu_type)

summary(completed_data$gpu_type)

```

#OS

```{r}
sum(is.na(completed_data$OS))
table(laptops$OS) #mode == "windows"
# Step 1: Convert the factor column to character
completed_data$OS <- as.character(completed_data$OS)
# Step 2: Replace NA values with "windows"
completed_data$OS[is.na(completed_data$OS)] <- "windows"
# Step 3: Convert the column back to factor
completed_data$OS <- as.factor(completed_data$OS)

summary(completed_data$OS)
```

```{r}
sum(is.na(completed_data))
str(completed_data)
```

There are no NA values in the dataset. All of them were imputed.


